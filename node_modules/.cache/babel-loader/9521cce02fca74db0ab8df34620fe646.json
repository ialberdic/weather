{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar STYLES = {};\n\ntry {\n  STYLES = {\n    'ellipsis': 'react-custom-flag-select__ellipsis___rpQ2I',\n    'select__wrapper': 'react-custom-flag-select__select__wrapper___11lzY',\n    'select__input': 'react-custom-flag-select__select__input___1s31X',\n    'select__container': 'react-custom-flag-select__select__container___1WS3q',\n    'error': 'react-custom-flag-select__error___DlrLx',\n    'success': 'react-custom-flag-select__success___2PDN0',\n    'disabled': 'react-custom-flag-select__disabled___1dmK6',\n    'select__options-item': 'react-custom-flag-select__select__options-item___1CxfE',\n    'select__options-item-show-cursor': 'react-custom-flag-select__select__options-item-show-cursor___3_qPb',\n    'select__no-mouse': 'react-custom-flag-select__select__no-mouse___3KPrE',\n    'select__hover-active': 'react-custom-flag-select__select__hover-active___2vlkC',\n    'active': 'react-custom-flag-select__active___1tD_D',\n    'select__options-container-animate': 'react-custom-flag-select__select__options-container-animate___uOOrw',\n    'show': 'react-custom-flag-select__show___TghHg',\n    'select__options-container': 'react-custom-flag-select__select__options-container___1IX1z',\n    'select__dropdown': 'react-custom-flag-select__select__dropdown___3StfM',\n    'select__dropdown-icon': 'react-custom-flag-select__select__dropdown-icon___2z384',\n    'select__dropdown-flag': 'react-custom-flag-select__select__dropdown-flag___4BdIy',\n    'select__dropdown-name': 'react-custom-flag-select__select__dropdown-name___Pa895',\n    'select__dropdown-icon-container': 'react-custom-flag-select__select__dropdown-icon-container___kW1px'\n  };\n} catch (ex) {}\n\nvar ERROR = 'Please provide valid optionList. i.e optionList=[{id: \"1\", name: \"United States\", flag: \"us.svg\"}, {id: \"86\", name: \"中国\", flag: \"cn.svg\"}]';\n\nif (!String.prototype.startsWith) {\n  String.prototype.startsWith = function (searchString, position) {\n    position = position || 0;\n    return this.indexOf(searchString, position) === position;\n  };\n}\n\nvar ReactCustomFlagSelect = function (_Component) {\n  _inherits(ReactCustomFlagSelect, _Component);\n\n  function ReactCustomFlagSelect(props) {\n    _classCallCheck(this, ReactCustomFlagSelect);\n\n    var _this = _possibleConstructorReturn(this, (ReactCustomFlagSelect.__proto__ || Object.getPrototypeOf(ReactCustomFlagSelect)).call(this, props));\n\n    _this.state = {\n      value: props.value,\n      show: false,\n      isTyping: false,\n      keycodeList: []\n    };\n\n    if (!props.optionList.length) {\n      console.error(ERROR);\n      return _possibleConstructorReturn(_this);\n    } else {\n      props.optionList.map(function (i) {\n        if (typeof i.name == 'undefined' || typeof i.id == 'undefined') {\n          console.error(ERROR);\n        }\n\n        return;\n      });\n    }\n\n    _this.optionItems = [];\n    _this.onChange = _this.onChange.bind(_this);\n    _this.onClick = _this.onClick.bind(_this);\n    _this.onBlur = _this.onBlur.bind(_this);\n    _this.onFocus = _this.onFocus.bind(_this);\n    _this.pageClick = _this.pageClick.bind(_this);\n    _this.onKeyDown = _this.onKeyDown.bind(_this);\n    return _this;\n  }\n\n  _createClass(ReactCustomFlagSelect, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      window.addEventListener('mousedown', this.pageClick);\n      window.addEventListener('touchstart', this.pageClick);\n      this.wrapper.addEventListener('keydown', this.onKeyDown);\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (prevState.show != this.state.show) {\n        if (this.state.show) {\n          this.resetCurrentFocus();\n        }\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      window.removeEventListener('mousedown', this.pageClick);\n      window.removeEventListener('touchstart', this.pageClick);\n      this.wrapper.removeEventListener('keydown', this.onKeyDown);\n    }\n  }, {\n    key: 'onChange',\n    value: function onChange(value, e) {\n      var onChange = this.props.onChange;\n      onChange && onChange(value, e);\n      this.setState({\n        value: value\n      });\n    }\n  }, {\n    key: 'onClick',\n    value: function onClick(e) {\n      var onClick = this.props.onClick;\n      onClick && onClick(e);\n    }\n  }, {\n    key: 'onBlur',\n    value: function onBlur(e) {\n      var onBlur = this.props.onBlur;\n\n      if (onBlur) {\n        onBlur(e);\n      }\n    }\n  }, {\n    key: 'onFocus',\n    value: function onFocus(e) {\n      this.focus = true;\n      var onFocus = this.props.onFocus;\n\n      if (onFocus) {\n        onFocus(e);\n      }\n    }\n  }, {\n    key: 'getIndex',\n    value: function getIndex(list, val) {\n      var key = -1;\n\n      for (var i = 0; i < list.length; i++) {\n        if (list[i].id == val) {\n          key = i;\n          break;\n        }\n      }\n\n      return key;\n    }\n  }, {\n    key: 'resetCurrentFocus',\n    value: function resetCurrentFocus() {\n      var value = this.state.value;\n      var optionList = this.props.optionList;\n      this.currentFocus = this.getIndex(optionList, value);\n      this.scroll();\n    }\n  }, {\n    key: 'onKeyDown',\n    value: function onKeyDown(e) {\n      this.setState({\n        isTyping: true\n      });\n\n      if (e.preventDefault) {\n        e.preventDefault();\n      }\n\n      var _state = this.state,\n          show = _state.show,\n          value = _state.value;\n\n      if (!show) {\n        return;\n      }\n\n      var x = this.optionItems;\n      var optionList = this.props.optionList;\n      this.currentFocus = typeof this.currentFocus != 'undefined' ? this.currentFocus : this.getIndex(optionList, value);\n      var direction = null;\n      var keyCode = e.keyCode;\n      var keyCodeEsc = 27;\n      var keyCodeDown = 40;\n      var keyCodeUp = 38;\n      var keyCodeEnter = 13;\n      var selectKeyList = [keyCodeEsc, keyCodeDown, keyCodeUp, keyCodeEnter];\n\n      if (selectKeyList.indexOf(keyCode) != -1) {\n        if (keyCode == keyCodeEsc) {\n          this.setState({\n            show: false\n          });\n          this.resetCurrentFocus();\n          return;\n        }\n\n        if (keyCode == keyCodeDown) {\n          direction = 'down';\n          this.currentFocus++;\n\n          if (this.currentFocus > optionList.length - 1) {\n            this.currentFocus = optionList.length - 1;\n          }\n\n          this.addActive();\n        } else if (keyCode == keyCodeUp) {\n          direction = 'up';\n          this.currentFocus--;\n\n          if (this.currentFocus < 0) {\n            this.currentFocus = 0;\n          }\n\n          this.addActive();\n        } else if (keyCode == keyCodeEnter) {\n          if (this.currentFocus > -1) {\n            if (x) x[this.currentFocus].click();\n          }\n        }\n      } else {\n        var keycodeList = this.state.keycodeList;\n\n        if (!(keyCode >= 48 || keyCode <= 57 || keyCode >= 65 || keyCode <= 90 || keyCode >= 96 || keyCode <= 105)) {\n          return;\n        }\n\n        this.setTimeoutTyping();\n        var newkeyCodeList = [].concat(_toConsumableArray(keycodeList), [keyCode]);\n        var str = String.fromCharCode.apply(String, _toConsumableArray(newkeyCodeList)).toLowerCase();\n        var index = -1;\n        optionList.filter(function (i, k) {\n          var name = i.name,\n              displayText = i.displayText;\n\n          if (displayText) {\n            if (displayText.toLowerCase().startsWith(str)) {\n              if (index == -1) {\n                index = k;\n              }\n            }\n          } else {\n            if (name.toLowerCase().startsWith(str)) {\n              if (index == -1) {\n                index = k;\n              }\n            }\n          }\n        });\n\n        if (index != -1) {\n          this.currentFocus = index;\n          this.addActive();\n        }\n\n        this.setState({\n          keycodeList: newkeyCodeList\n        });\n      }\n\n      this.scroll(direction);\n      return this.currentFocus;\n    }\n  }, {\n    key: 'setTimeoutTyping',\n    value: function setTimeoutTyping() {\n      var _this2 = this;\n\n      if (this.typingTimeout) {\n        clearTimeout(this.typingTimeout);\n      }\n\n      this.typingTimeout = setTimeout(function () {\n        _this2.setState({\n          keycodeList: []\n        });\n      }, 250);\n    }\n  }, {\n    key: 'scroll',\n    value: function scroll(direction) {\n      var containerHeight = this.itemsWrapper.offsetHeight;\n      var containerScrollTop = this.itemsWrapper.scrollTop;\n\n      if (!this.optionItems[this.currentFocus]) {\n        return;\n      }\n\n      var itemHeight = this.optionItems[this.currentFocus].offsetHeight;\n\n      if (direction) {\n        if (direction == 'down') {\n          var bound = containerScrollTop + containerHeight;\n          var heightItems = this.currentFocus * itemHeight;\n          var heightContainer = bound - itemHeight;\n\n          if (heightItems >= heightContainer) {\n            var offset = Math.abs(heightItems - heightContainer - itemHeight);\n\n            if (offset >= 0 && !this.corrected) {\n              this.itemsWrapper.scrollTop = containerScrollTop + itemHeight - offset;\n              this.corrected = true;\n            } else {\n              this.itemsWrapper.scrollTop = containerScrollTop + itemHeight;\n            }\n          }\n        }\n\n        if (direction == 'up') {\n          this.corrected = false;\n\n          if (this.currentFocus * itemHeight <= containerScrollTop) {\n            this.itemsWrapper.scrollTop = this.currentFocus * itemHeight;\n          }\n        }\n      } else {\n        this.corrected = false;\n        this.itemsWrapper.scrollTop = this.currentFocus * itemHeight;\n      }\n    }\n  }, {\n    key: 'addActive',\n    value: function addActive() {\n      var x = this.optionItems;\n      if (!x) return false;\n      this.removeActive();\n      if (this.currentFocus >= x.length) this.currentFocus = 0;\n      if (this.currentFocus < 0) this.currentFocus = x.length - 1;\n      x[this.currentFocus].className += ' ' + STYLES['select__hover-active'];\n    }\n  }, {\n    key: 'removeActive',\n    value: function removeActive() {\n      var x = this.optionItems;\n\n      for (var i = 0; i < x.length; i++) {\n        x[i].className = x[i].className.replace(STYLES['select__hover-active'], '');\n      }\n    }\n  }, {\n    key: 'pageClick',\n    value: function pageClick(e) {\n      if (this.wrapper.contains(e.target)) {\n        return;\n      }\n\n      if (this.focus) {\n        this.onBlur();\n        this.focus = false;\n      }\n\n      this.toggleShow(false);\n    }\n  }, {\n    key: 'toggleShow',\n    value: function toggleShow(show) {\n      this.setState({\n        show: show\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this3 = this;\n\n      var _props = this.props,\n          tabIndex = _props.tabIndex,\n          id = _props.id,\n          name = _props.name,\n          optionList = _props.optionList,\n          disabled = _props.disabled,\n          classNameWrapper = _props.classNameWrapper,\n          classNameContainer = _props.classNameContainer,\n          classNameSelect = _props.classNameSelect,\n          classNameOptionListContainer = _props.classNameOptionListContainer,\n          classNameOptionListItem = _props.classNameOptionListItem,\n          classNameDropdownIconOptionListItem = _props.classNameDropdownIconOptionListItem,\n          customStyleWrapper = _props.customStyleWrapper,\n          customStyleContainer = _props.customStyleContainer,\n          customStyleSelect = _props.customStyleSelect,\n          customStyleOptionListContainer = _props.customStyleOptionListContainer,\n          customStyleOptionListItem = _props.customStyleOptionListItem,\n          selectHtml = _props.selectHtml,\n          selectOptionListItemHtml = _props.selectOptionListItemHtml;\n      var _state2 = this.state,\n          value = _state2.value,\n          show = _state2.show,\n          isTyping = _state2.isTyping;\n      var wrapperClass = (0, _classnames2.default)(classNameWrapper, STYLES['select__wrapper'], disabled && STYLES['disabled']);\n      var containerClass = (0, _classnames2.default)(classNameContainer, STYLES['select__container'], show && STYLES['show'], disabled && STYLES['disabled']);\n      var inputClass = (0, _classnames2.default)(STYLES['select__input'], disabled && STYLES['disabled']);\n      var selectClass = (0, _classnames2.default)(classNameSelect, STYLES['ellipsis'], disabled && STYLES['disabled']);\n      var selectOptionListContainerClass = (0, _classnames2.default)(classNameOptionListContainer, STYLES['select__options-container'], show && STYLES['show'], disabled && STYLES['disabled']);\n      var selectOptionListItemClass = (0, _classnames2.default)(!isTyping && STYLES['select__options-item-show-cursor'], classNameOptionListItem, STYLES['select__options-item'], disabled && STYLES['disabled']);\n      var dropdownIconClass = (0, _classnames2.default)(classNameDropdownIconOptionListItem, STYLES['select__dropdown-icon']);\n      var optionListHtml = void 0;\n      var item = void 0;\n      optionList.filter(function (i) {\n        if (String(i.id) == String(value)) {\n          item = i;\n        }\n      });\n\n      if (optionList.length) {\n        if (selectOptionListItemHtml) {\n          optionListHtml = selectOptionListItemHtml;\n        } else {\n          optionListHtml = optionList.map(function (i, k) {\n            return _react2.default.createElement('div', {\n              ref: function ref(_ref) {\n                return _this3.optionItems[k] = _ref;\n              },\n              onMouseOver: function onMouseOver() {\n                _this3.currentFocus = k;\n\n                _this3.addActive();\n              },\n              onMouseMove: function onMouseMove() {\n                _this3.setState({\n                  isTyping: false\n                });\n              },\n              onMouseOut: function onMouseOut() {\n                _this3.removeActive();\n              },\n              className: String(i.id) == String(value) ? selectOptionListItemClass + ' ' + STYLES['active'] : '' + selectOptionListItemClass,\n              key: k,\n              style: customStyleOptionListItem,\n              onClick: function onClick(e) {\n                _this3.onChange(i.id, e);\n              }\n            }, i.flag ? _react2.default.createElement('div', {\n              style: {\n                width: '30%'\n              }\n            }, _react2.default.createElement('img', {\n              src: i.flag,\n              style: {\n                width: '100%',\n                height: '100%',\n                verticalAlign: 'middle'\n              }\n            })) : '', _react2.default.createElement('div', null, i.displayText ? i.displayText : i.name));\n          });\n        }\n      }\n\n      var selectorHtml = selectHtml;\n      var flagHtml = void 0;\n\n      if (item.flag) {\n        flagHtml = _react2.default.createElement('div', {\n          className: STYLES['select__dropdown-flag'],\n          style: {\n            width: '30%'\n          }\n        }, _react2.default.createElement('img', {\n          src: item.flag,\n          style: {\n            width: '100%',\n            height: '100%',\n            verticalAlign: 'middle'\n          }\n        }));\n      }\n\n      if (!selectorHtml) {\n        selectorHtml = _react2.default.createElement('div', {\n          className: STYLES['select__dropdown']\n        }, flagHtml, '\\xA0', _react2.default.createElement('div', {\n          className: STYLES['select__dropdown-name'] + ' ' + STYLES['ellipsis']\n        }, item.id, '\\xA0'), _react2.default.createElement('div', {\n          className: dropdownIconClass\n        }));\n      }\n\n      return _react2.default.createElement('div', {\n        tabIndex: tabIndex,\n        id: STYLES['select__wrapper'],\n        className: wrapperClass,\n        style: customStyleWrapper,\n        onClick: function onClick(e) {\n          _this3.onClick(e);\n\n          !disabled ? _this3.toggleShow(!show) : '';\n        },\n        onFocus: this.onFocus,\n        onBlur: this.onBlur,\n        ref: function ref(_ref4) {\n          return _this3.wrapper = _ref4;\n        }\n      }, _react2.default.createElement('div', {\n        className: containerClass,\n        style: customStyleContainer\n      }, _react2.default.createElement('input', {\n        id: id,\n        name: name,\n        type: 'hidden',\n        value: value,\n        className: inputClass,\n        onChange: function onChange() {},\n        ref: function ref(_ref2) {\n          return _this3.input = _ref2;\n        }\n      }), _react2.default.createElement('div', {\n        className: selectClass,\n        style: customStyleSelect\n      }, selectorHtml), _react2.default.createElement('div', {\n        ref: function ref(_ref3) {\n          return _this3.itemsWrapper = _ref3;\n        },\n        className: selectOptionListContainerClass,\n        style: customStyleOptionListContainer\n      }, optionListHtml)));\n    }\n  }], [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      if (prevState.value !== nextProps.value) {\n        return {\n          value: nextProps.value\n        };\n      }\n\n      return null;\n    }\n  }]);\n\n  return ReactCustomFlagSelect;\n}(_react.Component);\n\nReactCustomFlagSelect.defaultProps = {\n  tabIndex: -1,\n  id: '',\n  name: '',\n  value: '',\n  disabled: false,\n  optionList: [],\n  classNameWrapper: '',\n  classNameContainer: '',\n  classNameOptionListItem: '',\n  classNameOptionListContainer: '',\n  classNameDropdownIconOptionListItem: '',\n  customStyleWrapper: {},\n  customStyleContainer: {},\n  customStyleSelect: {},\n  customStyleOptionListItem: {},\n  customStyleOptionListContainer: {},\n  customStyleDropdownIcon: {},\n  onChange: function onChange() {}\n};\nReactCustomFlagSelect.propTypes = {\n  tabIndex: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.number]),\n  id: _propTypes2.default.string,\n  name: _propTypes2.default.string,\n  value: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.number]),\n  disabled: _propTypes2.default.bool,\n  validate: _propTypes2.default.bool,\n  optionList: _propTypes2.default.array.isRequired,\n  onChange: _propTypes2.default.func.isRequired,\n  onClick: _propTypes2.default.func,\n  onBlur: _propTypes2.default.func,\n  onFocus: _propTypes2.default.func,\n  validationOption: _propTypes2.default.object,\n  locale: _propTypes2.default.string,\n  selectHtml: _propTypes2.default.element,\n  selectOptionListItemHtml: _propTypes2.default.array,\n  classNameWrapper: _propTypes2.default.string,\n  classNameContainer: _propTypes2.default.string,\n  classNameSelect: _propTypes2.default.string,\n  classNameOptionListContainer: _propTypes2.default.string,\n  classNameDropdownIconOptionListItem: _propTypes2.default.string,\n  classNameOptionListItem: _propTypes2.default.string,\n  customStyleWrapper: _propTypes2.default.object,\n  customStyleContainer: _propTypes2.default.object,\n  customStyleSelect: _propTypes2.default.object,\n  customStyleOptionListContainer: _propTypes2.default.object,\n  customStyleDropdownIcon: _propTypes2.default.object,\n  customStyleOptionListItem: _propTypes2.default.object\n};\nexports.default = ReactCustomFlagSelect;","map":null,"metadata":{},"sourceType":"script"}